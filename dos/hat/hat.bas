100 REM plots the HAT function on color graphics monitor
110 REM requires approx. 45min to complete
120 CLEAR:SCREEN 1:KEY OFF:CLS:COLOR 0,3
130 P=160:Q=100
140 XP=144:XR=1.5*3.1415927#
150 YP=56:YR=1:ZP=64
160 XF=XR/XP:YF=YP/YR:ZF=XR/ZP
170 FOR ZI=-Q TO Q-1
180 IF ZI<-ZP OR ZI>ZP GOTO 260
190 ZT=ZI*XP/ZP:ZZ=ZI
200 XL=INT(.5+SQR(XP*XP-ZT*ZT))
210 FOR XI=-XL TO XL
220 XT=SQR(XI*XI+ZT*ZT)*XF:XX=XI
230 YY=(SIN(XT)+.4*SIN(3*XT))*YF
240 GOSUB 290
250 NEXT XI
260 NEXT ZI
270 C$=INKEY$:IF C$<>" " THEN 270
280 SCREEN 0,0:WIDTH 80:CLS:KEY ON:END
290 X1=P-XX-ZZ
300 Y1=Q-YY+ZZ
310 PSET (X1,Y1),3
320 IF Y1=200 THEN 340
330 LINE (X1,Y1+1)-(X1,200),0
340 RETURN
